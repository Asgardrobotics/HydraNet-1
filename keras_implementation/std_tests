from keras_implementation.utilities import data_generator, image_utils, logger
from os.path import join


def main(data_dir):
    """
    The main function for this file

    :param data_dir: The directory of the training data
    :type data_dir: str

    :return: None
    """

    # Get training examples from data_dir using data_generator
    x_original, y_original, stds = data_generator.pair_data_generator(data_dir)

    # Get std[1] and corresponding x_original and y_original patch
    std_1 = stds[1]
    x_original_1 = x_original[1]
    y_original_1 = y_original[1]

    # Plot the standard deviations
    image_utils.plot_standard_deviations(stds)

    # Show the standard deviation and corresponding image patches
    print(f'Standard Deviation = {std_1}')
    logger.show_images([("x_original_1", x_original_1),
                        ("y_original_1", y_original_1)])


if __name__ == '__main__':
    main(data_dir=join('data', 'Volume1', 'train'))